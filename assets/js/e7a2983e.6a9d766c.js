"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[74594],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>k});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=r.createContext({}),s=function(e){var t=r.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,c=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=s(a),k=n,m=u["".concat(c,".").concat(k)]||u[k]||d[k]||l;return a?r.createElement(m,i(i({ref:t},p),{},{components:a})):r.createElement(m,i({ref:t},p))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=u;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var s=2;s<l;s++)i[s]=a[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},34625:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var r=a(87462),n=(a(67294),a(3905));const l={title:"Tracking events",date:"2020-02-26",sidebar_position:40},i=void 0,o={unversionedId:"migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/index",id:"migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/index",title:"Tracking events",description:"Creating a Tracker",source:"@site/docs/migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/index.md",sourceDirName:"migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events",slug:"/migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/",permalink:"/docs/migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/migrated/collecting-data/collecting-from-own-applications/lua-tracker/tracking-specific-events/index.md",tags:[],version:"current",lastUpdatedAt:1660570896,formattedLastUpdatedAt:"Aug 15, 2022",sidebarPosition:40,frontMatter:{title:"Tracking events",date:"2020-02-26",sidebar_position:40},sidebar:"tutorialSidebar",previous:{title:"Lua Tracker",permalink:"/docs/migrated/collecting-data/collecting-from-own-applications/lua-tracker/"},next:{title:"API documentation",permalink:"/docs/migrated/collecting-data/collecting-from-own-applications/lua-tracker/api-documentation/"}},c={},s=[{value:"Creating a Tracker",id:"creating-a-tracker",level:2},{value:"Track structured events with\xa0<code>track_struct_event</code>",id:"track-structured-events-withtrack_struct_event",level:2},{value:"Track self-describing events with\xa0<code>track_self_describing_event</code>",id:"track-self-describing-events-withtrack_self_describing_event",level:2},{value:"Track screen views with\xa0<code>track_screen_view</code>",id:"track-screen-views-withtrack_screen_view",level:2},{value:"Configuring the Tracker",id:"configuring-the-tracker",level:2},{value:"Tracker Method Return Values",id:"tracker-method-return-values",level:2},{value:"Adding user and platform data",id:"adding-user-and-platform-data",level:2}],p={toc:s};function d(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"creating-a-tracker"},"Creating a Tracker"),(0,n.kt)("p",null,"Creating a tracking instance is as simple as calling\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"snowplow.new_tracker"),"\xa0and providing a URL for your collector:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'local snowplow = require("snowplow")\nlocal tracker = snowplow.new_tracker("{{ collector_url }}")\n')),(0,n.kt)("p",null,"Tracking methods supported by the Lua Tracker:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Method"),(0,n.kt)("th",{parentName:"tr",align:null},"Event type tracked"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"track","_","screen","_","view"),(0,n.kt)("td",{parentName:"tr",align:null},"View of screen")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"track","_","struct","_","event"),(0,n.kt)("td",{parentName:"tr",align:null},"Semi-custom structured event")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"track","_","self","_","describing","_","event"),(0,n.kt)("td",{parentName:"tr",align:null},"Custom event based on \u201cself-describing\u201d JSON schema")))),(0,n.kt)("h2",{id:"track-structured-events-withtrack_struct_event"},"Track structured events with\xa0",(0,n.kt)("inlineCode",{parentName:"h2"},"track_struct_event")),(0,n.kt)("p",null,"This method provides a halfway-house between tracking fully user-defined self-describing events and out-of-the box predefined events. This event type can be used to track many types of user activity, as it is somewhat customizable. \u201cStruct\u201d events closely mirror the structure of Google Analytics events, with \u201ccategory\u201d, \u201caction\u201d, \u201clabel\u201d, and \u201cvalue\u201d properties."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Required in event?"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"category"),(0,n.kt)("td",{parentName:"tr",align:null},"The grouping of structured events which this action belongs to"),(0,n.kt)("td",{parentName:"tr",align:null},"Yes")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"action"),(0,n.kt)("td",{parentName:"tr",align:null},"Defines the type of user interaction which this event involves"),(0,n.kt)("td",{parentName:"tr",align:null},"Yes")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"label"),(0,n.kt)("td",{parentName:"tr",align:null},"Often used to refer to the \u2018object\u2019 the action is performed on"),(0,n.kt)("td",{parentName:"tr",align:null},"No")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"property"),(0,n.kt)("td",{parentName:"tr",align:null},"Describing the \u2018object\u2019, or the action performed on it"),(0,n.kt)("td",{parentName:"tr",align:null},"No")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"value"),(0,n.kt)("td",{parentName:"tr",align:null},"Provides numerical data about the event"),(0,n.kt)("td",{parentName:"tr",align:null},"No")))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'tracker:track_struct_event("shop", "add-to-basket", "book", "pcs", 2)\n')),(0,n.kt)("h2",{id:"track-self-describing-events-withtrack_self_describing_event"},"Track self-describing events with\xa0",(0,n.kt)("inlineCode",{parentName:"h2"},"track_self_describing_event")),(0,n.kt)("p",null,"Use\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"track_self_describing_event"),"\xa0to track a custom event. This is the most advanced and powerful tracking method, which requires a certain amount of planning and infrastructure. A guide to understanding Self-Describing events is\xa0",(0,n.kt)("a",{parentName:"p",href:"/docs/migrated/understanding-tracking-design/out-of-the-box-vs-custom-events-and-entities/#self-describing-events"},"available here"),"."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Required in event?"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"schema"),(0,n.kt)("td",{parentName:"tr",align:null},"The schema to use"),(0,n.kt)("td",{parentName:"tr",align:null},"Yes")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"action"),(0,n.kt)("td",{parentName:"tr",align:null},"The data to send along with the schema"),(0,n.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'tracker:track_self_describing_event(\n  "iglu:com.snowplowanalytics.snowplow/add_to_cart/jsonschema/1-0-0",\n  { sku = "ASO01043", unitPrice = 49.95, quantity = 1000 }\n)\n')),(0,n.kt)("h2",{id:"track-screen-views-withtrack_screen_view"},"Track screen views with\xa0",(0,n.kt)("inlineCode",{parentName:"h2"},"track_screen_view")),(0,n.kt)("p",null,"Use track","_","screen","_","view to track a user viewing a screen (or similar) within your app. This is the page view equivalent for apps that are not webpages."),(0,n.kt)("p",null,"This method uses a self-describing event with the\xa0",(0,n.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/screen_view/jsonschema/1-0-0"},(0,n.kt)("inlineCode",{parentName:"a"},"com.snowplowanalytics.snowplow/screen_view"),"\xa0schema"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'tracker:track_screen_view("Character Creation - Step 1", "c1")\n')),(0,n.kt)("h2",{id:"configuring-the-tracker"},"Configuring the Tracker"),(0,n.kt)("p",null,"The\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"new_tracker"),"\xa0method has a couple of other parameters that can be used to configure your tracker instance, along with the collector\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"url"),"."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Required"),(0,n.kt)("th",{parentName:"tr",align:null},"Default"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"url"),(0,n.kt)("td",{parentName:"tr",align:null},"The Snowplow Collector URL"),(0,n.kt)("td",{parentName:"tr",align:null},"Yes"),(0,n.kt)("td",{parentName:"tr",align:null},"-")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"request","_","type"),(0,n.kt)("td",{parentName:"tr",align:null},'The request type to use ("GET" or "POST")'),(0,n.kt)("td",{parentName:"tr",align:null},"No"),(0,n.kt)("td",{parentName:"tr",align:null},'"POST"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"encode","_","base64"),(0,n.kt)("td",{parentName:"tr",align:null},"If self-describing event payloads are base64 encoded"),(0,n.kt)("td",{parentName:"tr",align:null},"No"),(0,n.kt)("td",{parentName:"tr",align:null},"true")))),(0,n.kt)("p",null,"Note: It's generally recommended to use the default values as\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"encode_base64 = true"),"\xa0can reduce the size of payloads and\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"POST"),"\xa0will receive more future support (such as batched requests), but you can change these if your use case calls for it."),(0,n.kt)("h2",{id:"tracker-method-return-values"},"Tracker Method Return Values"),(0,n.kt)("p",null,"A call to a\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"track_*"),"\xa0method will return two values, a boolean if the request was successful, and an optional error message if the request was not successful."),(0,n.kt)("p",null,"An example of the values returned from a failed request:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'local ok, err = tracker:track_screen_view("Character Configuration - Part 1", "c1")\n-- false, Host [https://test.invalid/com.snowplowanalytics.snowplow/tp2] not found (possible connectivity error)\n')),(0,n.kt)("p",null,"An example of the values returned from a successful request:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'local ok, err = tracker:track_screen_view("Character Configuration - Part 1", "c1")\n-- true, nil\n')),(0,n.kt)("h2",{id:"adding-user-and-platform-data"},"Adding user and platform data"),(0,n.kt)("p",null,"The tracker can store information about the user associated with the event, such as their\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"user_id"),", what type of device they used, or what size screen that device had. It also stores which platform the event occurred on \u2013 e.g. server-side app, mobile, games console, etc. This is done through the provided\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"set_*"),"\xa0methods available on a tracker instance. The stored information is attached to the tracked events using fields described in the\xa0",(0,n.kt)("a",{parentName:"p",href:"/docs/migrated/collecting-data/collecting-from-own-applications/snowplow-tracker-protocol/"},"Tracker Protocol"),"."),(0,n.kt)("p",null,"For a full list of setters, check out the\xa0",(0,n.kt)("a",{parentName:"p",href:"https://snowplow.github.io/snowplow-lua-tracker/modules/Tracker.html"},"Tracker API Documentation"),"."))}d.isMDXComponent=!0}}]);